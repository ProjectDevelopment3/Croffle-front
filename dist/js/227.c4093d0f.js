"use strict";(self["webpackChunkcroffle_frontend"]=self["webpackChunkcroffle_frontend"]||[]).push([[227],{797:function(e,a,n){n.d(a,{Dk:function(){return o},UB:function(){return i},j2:function(){return r}});var t=n(3376);function o(){return t.eE.get("cafes")}function r(e){return t.eE.get(`cafe?id=${e}`)}function i(e){return t.eE.get(`cafe/search?name=${e}`)}},8672:function(e,a,n){n.r(a),n.d(a,{default:function(){return V}});var t=n(3396),o=n(7139);const r={key:0,class:"search"},i={key:1},s=["src"],c={key:0,class:"infoWindow"},d={class:"map__wrapper"},l=(0,t._)("p",{class:"guide",id:"guide"},[(0,t.Uk)(" 원정대에게 알려주고 싶은 카페가 있나요?"),(0,t._)("br"),(0,t.Uk)(" 카페를 찾아 크로플 원정대에 제보해주세요! ")],-1);function f(e,a,n,f,p,u){const m=(0,t.up)("searchbar-component"),h=(0,t.up)("not-registered-cafe"),g=(0,t.up)("cafe-list-component"),w=(0,t.up)("naver-marker"),v=(0,t.up)("naver-info-window"),k=(0,t.up)("naver-maps");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t.Wm)(m,{onShowResult:u.showResult,onFetchInfo:u.fetchInfo,onFetchResult:u.fetchResult,service:p.service,registered:p.registered},null,8,["onShowResult","onFetchInfo","onFetchResult","service","registered"]),0==p.service?((0,t.wg)(),(0,t.iD)("div",r,[0==p.registered?((0,t.wg)(),(0,t.j4)(h,{key:0,onClosePage:a[0]||(a[0]=e=>p.service=!0)})):(0,t.kq)("",!0),1==p.registered?((0,t.wg)(),(0,t.j4)(g,{key:1,onClosePage:a[1]||(a[1]=e=>p.service=!0)})):(0,t.kq)("",!0)])):(0,t.kq)("",!0),1==p.service?((0,t.wg)(),(0,t.iD)("div",i,[(0,t.Wm)(k,{width:"100%",height:"100vh",class:"main-container--map",onOnLoad:a[4]||(a[4]=a=>e.onLoadMap(p.cafes))},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(p.cafes,((n,r)=>((0,t.wg)(),(0,t.j4)(w,{key:r,latitude:n.mapy,longitude:n.mapx,onOnLoad:a[2]||(a[2]=a=>e.onLoadMarker(a)),onClick:e=>u.openInfo(n[r].id)},{default:(0,t.w5)((()=>[(0,t._)("img",{src:p.ic__marker},null,8,s),p.isWindowOpen?((0,t.wg)(),(0,t.iD)("div",c,(0,o.zw)(n[r].id),1)):(0,t.kq)("",!0)])),_:2},1032,["latitude","longitude","onClick"])))),128)),(0,t.Wm)(v,{marker:e.marker,isOpen:e.isOpen,onOnLoad:a[3]||(a[3]=a=>e.onLoadInfoWindow(e.event))},null,8,["marker","isOpen"])])),_:1}),(0,t._)("div",d,[l,(0,t._)("button",{type:"button",onClick:a[5]||(a[5]=(...e)=>u.toCafeReport&&u.toCafeReport(...e)),class:"btn--primary",id:"btn-report"}," 제보하기 + ")])])):(0,t.kq)("",!0)])}var p=n.p+"img/speechBubble.a260e7b2.svg",u=n.p+"img/marker.22f42703.svg",m=n(797);const h={id:"not-regi-cafe",class:"container"},g=(0,t._)("i",{class:"fas fa-arrow-left fa-2x"},null,-1),w=[g],v=(0,t._)("p",null,[(0,t.Uk)(" 아직 등록되지 않은 카페네요."),(0,t._)("br"),(0,t.Uk)(" 조금만 기다려 주세요! ")],-1);function k(e,a,n,o,r,i){return(0,t.wg)(),(0,t.iD)("div",h,[(0,t._)("button",{onClick:a[0]||(a[0]=a=>e.$emit("close-page"))},w),v])}var _={},y=n(89);const b=(0,y.Z)(_,[["render",k]]);var C=b;const L={id:"cafe-list",class:"container"},R={class:"card__wrapper--column"},D={class:"text__name"},I={class:"text__addr"},O=(0,t._)("i",{class:"far fa-times-circle fa-2x"},null,-1),$=[O];function x(e,a,n,r,i,s){return(0,t.wg)(),(0,t.iD)("div",L,[(0,t._)("div",R,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(n.cafeList,(e=>((0,t.wg)(),(0,t.iD)("div",{key:e.id,class:"cafe__card"},[(0,t._)("span",D,(0,o.zw)(e.name),1),(0,t._)("span",I,(0,o.zw)(e.addr),1)])))),128))]),(0,t._)("button",{onClick:a[0]||(a[0]=a=>e.$emit("close-page"))},$)])}var W={data(){return{}},props:{cafeList:[{name:"카페 이름1",addr:"주소1"},{name:"카페 이름2",addr:"주소2"}]}};const H=(0,y.Z)(W,[["render",x]]);var M=H,S=n(9242);const U={id:"searchbar"},q={class:"input__box"},F=["src"];function j(e,a,n,o,r,i){return(0,t.wg)(),(0,t.iD)("div",U,[(0,t._)("div",q,[(0,t.wy)((0,t._)("input",{placeholder:"크로플 원정을 떠날 카페를 검색해주세요.","onUpdate:modelValue":a[0]||(a[0]=e=>r.name=e)},null,512),[[S.nr,r.name]]),(0,t._)("button",{type:"button",onClick:a[1]||(a[1]=(...e)=>i.searchCafe&&i.searchCafe(...e))},[(0,t._)("img",{src:r.ic_magnifier},null,8,F)])])])}var Z=n.p+"img/position.c2587f93.svg",B=n.p+"img/magnifier.ba2bdae4.svg",K={data(){return{ic_position:Z,ic_magnifier:B,address:"서울특별시 성북구",name:"",cafeInfo:[]}},methods:{async searchCafe(){const e=!1;this.$emit("showResult",e);try{console.log("등록된 카페 여부 검색");const{cafeData:e}=await(0,m.UB)(this.name);if("4040"==e.code){const e=!1;this.$emit("fetchResult",e)}else{const a=!1;this.$emit("fetchResult",a,e)}}catch(a){console.log(a)}}}};const N=(0,y.Z)(K,[["render",j]]);var z=N,A=n(4870),E=n(8960),P=n(5008),T={components:{SearchbarComponent:z,NaverMaps:E.K0,NaverMarker:E.At,NaverInfoWindow:E._T,NotRegisteredCafe:C,CafeListComponent:M},setup:()=>{const e=(0,A.iH)(),a=(0,A.iH)(),n=(0,A.iH)(),t=(0,A.iH)(!1),o=e=>{n.value=e},r=e=>{a.value=e},i=e=>{console.log("cafes",e),e=e.map((e=>(window.naver.maps.Service.geocode({address:e.roadaddr},(function(a,n){if(a!==window.naver.maps.Service.Status.OK)return alert("Something wrong!");var t=n.result;console.log("도로명 주소->좌표 반환결과",t.items[0].point),e.mapx=parseFloat(t.items[0].point.x),e.mapy=parseFloat(t.items[0].point.y)})),console.log("카페 도로명 주소",e),e)))};return{onLoadMarker:r,map:e,marker:a,onLoadMap:i,isOpen:t,onLoadInfoWindow:o}},mounted(){const e=this.$route.query.token;console.log("token",e),this.$store.commit("setToken",e),(0,P.aZ)(e)},async created(){let e=!0;this.$store.commit("isHeaderActive",e),await this.fetchCafes()},data(){return{registered:!1,ic__speechBubble:p,ic__marker:u,page:"main",clientIp:"",clientAddr:"",service:!0,email:"",cafeList:[],cafes:[{id:"0",name:"메가 커피",roadaddr:"서울 중구 세종대로 135",mapx:0,mapy:0},{id:"2",name:"빽다방",roadaddr:"서울 중구 세종대로22길 16",mapx:0,mapy:0},{id:"3",name:"투썸",roadaddr:"서울 중구 세종대로 110 서울특별시청 ",mapx:0,mapy:0}],isWindowOpen:!1}},methods:{fetchInfo(e){this.cafeInfo=e},fetchResult(e,a){this.registered=e,this.cafeList=a},showResult(e){this.service=e},toCafeReport(){this.$router.push("/cafes/report")},async fetchCafes(){try{console.log("전체 카페 조회(지도 출력)");const{cafeData:e}=await(0,m.Dk)();this.cafes.id=e.data.id,this.cafes.name=e.data.name,this.cafes.roadaddr=e.data.addr}catch(e){console.log(e)}},openInfo(e){this.$router.push(`cafe/${e}`),console.log(e),this.isWindowOpen},openInfoWindow(e){console.log("jh cafe",this.marker,e),this.marker=new window.naver.maps.Marker({position:new window.naver.maps.LatLng(e.mapy,e.mapx),map:window.naver.maps}),this.isOpen=!this.isOpen}}};const Y=(0,y.Z)(T,[["render",f]]);var V=Y}}]);
//# sourceMappingURL=227.c4093d0f.js.map