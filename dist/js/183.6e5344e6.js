"use strict";(self["webpackChunkcroffle_frontend"]=self["webpackChunkcroffle_frontend"]||[]).push([[183],{797:function(e,a,n){n.d(a,{D:function(){return t},j:function(){return r}});var o=n(3376);function t(){return o.eE.get("cafes")}function r(e){const a={id:e};return o.eE.get("cafe",{params:a})}},2862:function(e,a,n){n.r(a),n.d(a,{default:function(){return A}});var o=n(3396);const t=["src"],r=(0,o._)("div",{class:"infowindow-style"},"click Marker!😎",-1),i={class:"map__wrapper"},s=(0,o._)("p",{class:"guide",id:"guide"},[(0,o.Uk)(" 원정대에게 알려주고 싶은 카페가 있나요?"),(0,o._)("br"),(0,o.Uk)(" 카페를 찾아 크로플 원정대에 제보해주세요! ")],-1);function c(e,a,n,c,d,p){const l=(0,o.up)("searchbar-component"),m=(0,o.up)("naver-marker"),u=(0,o.up)("naver-info-window"),f=(0,o.up)("naver-maps");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(l),(0,o.Wm)(f,{width:"100%",height:"100vh",class:"main-container--map",onOnLoad:a[2]||(a[2]=a=>e.onLoadMap(d.cafes))},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(d.cafes,(n=>((0,o.wg)(),(0,o.j4)(m,{key:n.id,latitude:n.mapy,longitude:n.mapx,onOnLoad:a[0]||(a[0]=a=>e.onLoadMarker(a)),onClick:e=>p.openInfoWindow(n)},{default:(0,o.w5)((()=>[(0,o._)("img",{src:d.ic__marker},null,8,t)])),_:2},1032,["latitude","longitude","onClick"])))),128)),(0,o.Wm)(u,{marker:e.marker,isOpen:e.isOpen,onOnLoad:a[1]||(a[1]=a=>e.onLoadInfoWindow(a))},{default:(0,o.w5)((()=>[r])),_:1},8,["marker","isOpen"])])),_:1}),(0,o._)("div",i,[s,(0,o._)("button",{type:"button",onClick:a[3]||(a[3]=(...e)=>p.toCafeReport&&p.toCafeReport(...e)),class:"btn--primary",id:"btn-report"}," 제보하기 + ")])])}var d=n.p+"img/speechBubble.a260e7b2.svg",p=n.p+"img/marker.22f42703.svg",l=n(3376),m=n(797),u=n(7139);const f={id:"searchbar"},h={class:"searchbar__address"},g=["src"],w=(0,o._)("span",null,[(0,o._)("strong",null,"현재 위치")],-1),_={class:"address"},v={class:"input__box"},k=(0,o._)("input",{placeholder:"크로플 원정을 떠날 지역, 카페를 검색해주세요."},null,-1),b=["src"];function y(e,a,n,t,r,i){return(0,o.wg)(),(0,o.iD)("div",f,[(0,o._)("div",h,[(0,o._)("img",{src:r.ic_position},null,8,g),w,(0,o._)("span",_,(0,u.zw)(r.address),1)]),(0,o._)("div",v,[k,(0,o._)("button",{type:"button",onClick:a[0]||(a[0]=(...a)=>e.search&&e.search(...a))},[(0,o._)("img",{src:r.ic_magnifier},null,8,b)])])])}var C=n.p+"img/position.c2587f93.svg",L=n.p+"img/magnifier.ba2bdae4.svg",I={data(){return{ic_position:C,ic_magnifier:L,address:"서울특별시 성북구"}}},x=n(89);const O=(0,x.Z)(I,[["render",y]]);var W=O,D=n(4870),M=n(8960),H=n(5008),S={components:{SearchbarComponent:W,NaverMaps:M.K0,NaverMarker:M.At,NaverInfoWindow:M._T},setup:()=>{const e=(0,D.iH)(),a=(0,D.iH)(),n=(0,D.iH)(),o=(0,D.iH)(!1),t=e=>{n.value=e},r=e=>{a.value=e},i=e=>{console.log("cafes",e),e=e.map((e=>(window.naver.maps.Service.geocode({address:e.roadaddr},(function(a,n){if(a!==window.naver.maps.Service.Status.OK)return alert("Something wrong!");var o=n.result;console.log("도로명 주소->좌표 반환결과",o.items[0].point),e.mapx=parseFloat(o.items[0].point.x),e.mapy=parseFloat(o.items[0].point.y)})),console.log("카페 도로명 주소",e),e)))};return{onLoadMarker:r,map:e,marker:a,onLoadMap:i,isOpen:o,onLoadInfoWindow:t}},mounted(){const e=new window.naver_id_login("WDBUTDGAh6YGJ6Umihxr","http://34.64.32.174:8080/oauth2/authorization/naver?redirect_uri=http://34.64.45.86/cafes"),a=e.getAccessToken();console.log("access token",a),this.$store.commit("setToken",a),(0,H.aZ)(a)},async created(){let e=!0;this.$store.commit("isHeaderActive",e),await this.getIpClient(),await this.fetchLocation2(),this.fetchCafes()},data(){return{ic__speechBubble:d,ic__marker:p,page:"main",clientIp:"",clientAddr:"",cafes:[{id:"0",name:"",roadaddr:"서울 중구 세종대로 135",coords:"",mapx:0,mapy:0},{id:"2",name:"",roadaddr:"서울 중구 세종대로22길 16",coords:"",mapx:0,mapy:0},{id:"3",name:"",roadaddr:"서울 중구 세종대로 110 서울특별시청 ",coords:"",mapx:0,mapy:0}]}},methods:{toCafeReport(){this.$router.push("/cafes/report")},async fetchCafes(){try{console.log("전체 카페 조회(지도 출력)");const{cafeData:e}=await(0,m.D)();this.cafes.id=e.data.id,this.cafes.name=e.data.name,this.cafes.roadaddr=e.data.roadaddr}catch(e){console.log(e)}},selectCafe(e){this.$router.push(`cafe/${e.id}`)},async getIpClient(){try{const e=await(0,l.aG)();console.log("클라이언드 ip 주소",e.data),this.clientIp=e.data.toString()}catch(e){console.error(e)}},async fetchLocation2(){try{console.log("jh clientIp",this.clientIp);const e=await(0,l.Kx)(this.clientIp);console.log("jh test",e)}catch(e){console.error(e.message)}},openInfoWindow(e){console.log("jh cafe",this.marker,e),this.marker=new window.naver.maps.Marker({position:new window.naver.maps.LatLng(e.mapy,e.mapx),map:window.naver.maps}),this.isOpen=!this.isOpen}}};const j=(0,x.Z)(S,[["render",c]]);var A=j}}]);
//# sourceMappingURL=183.6e5344e6.js.map